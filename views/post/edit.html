<!-- style -->
<%- Loader('/public/css/post.css')
.css('/public/lib/editor/editor.css')
.css('/public/lib/webuploader/webuploader.css')
.css('/public/lib/code-prettify/prettify.css')
.done(assets, config.site_static_host, config.mini_assets)
%>
<div class="wrap">
    <div class='container'>
        <div class='row'>
            <div class="col-xs-12 col-lg-9">
                <div class="content-header left-content">
                    <h1 class="h4"><%= typeof(title) !== 'undefined' && title || '发表文章' %></h1>
                </div>
                <div class="mt-10">
                    <% if(typeof(edit_error) !== 'undefined' && edit_error){ %>
                    <div class="alert alert-danger">
                        <a class="close" data-dismiss="alert" href="#">&times;</a>
                        <strong><%= edit_error %></strong>
                    </div>
                    <% } %>
                    <% if(typeof(error) !== 'undefined' && error){ %>
                    <div class="alert alert-danger">
                        <strong><%= error %></strong>
                    </div>
                    <% }else{ %>
                    <% if (typeof(action) !== 'undefined' && action === 'edit') { %>
                    <form id='create_topic_form' action='/post/<%= post_id %>/edit' method='post' class="form-horizontal" >
                        <% } else { %>
                        <form id='create_topic_form' action='/post/create' method='post' class="form-horizontal">
                            <% } %>
                            <fieldset>
                                <span id="topic_create_warn"></span>
                                <div class="form-group">
                                    <!--[if lte IE 9]>
                                    <span>分类</span>
                                    <![endif]-->
                                    <div class="col-md-3">
                                        
                                        <select class="form-control" name="category" id="tab-value" autofocus>
                                            <option >请选择</option>
                                            <%
                                            config.tabs.forEach(function (pair) {
                                            var value = pair[0];
                                            var text = pair[1];
                                            %>
                                            <option value="<%=value%>"
                                            <%= (typeof(category) !== 'undefined' && category === value) ? 'selected': '' %>><%=text%></option>
                                            
                                            <%});%>
                                        </select>
                                    </div>
                                </div>
                                <!--[if lte IE 9]>
                                <span>标题</span>
                                <![endif]-->
                                <div class="form-group">
                                    <div class="col-md-12"><input type="text" class="form-control" id="title" placeholder="标题字数10字以上" name="title" value="<%= typeof(post_title) !== 'undefined' && post_title || '' %>"></div>
                                </div>
                                <!--[if lte IE 9]>
                                <!--<span>摘要</span>-->
                                <![endif]-->
                                <!--[if lte IE 9]>
                                <span>标签</span>
                                <![endif]-->
                                <div class="form-group">
                                    <div class="col-md-3">
                                        <input id="tag_autocomplete" type="text"
                                        class="form-control" placeholder="标签，如：javascript"/>
                                    </div>
                                </div>
                                
                                <% if(typeof(tags) !== 'undefined') {
                                %>
                                <div class="form-group" id="tagGroup">
                                <%
                                        tags.forEach(function (tag,index){
                                        
                                        if(tag) {
                                        %>
                                        
                                            <div class="col-md-3 tag-col-gutter-vertical">
                                                <div class="input-group">
                                                    <input type="text" class="form-control select-tag input-sm"
                                                    id="exampleInputAmount" placeholder="" disabled="disabled"
                                                    value="<%= tag %>">
                                                    <a class="input-group-addon tag-close"
                                                    href="javascript:void(0);">&times;</a>
                                                </div>
                                            </div>
                                            
                                        <%
                                        }
                                        });
                                        %>
                                 </div>
                                    <%
                                    } %>
                                <input type="hidden" id="tags" name="tags" value=""/>
                                <!--[if lte IE 9]>
                                <span>正文</span>
                                <![endif]-->
                                <div class='markdown_editor in_editor'>
                                    <div class='markdown_in_editor'>
                                        <textarea class='editor' name='content' rows='20'
                                        placeholder='文章支持 Markdown 语法, 请注意标记代码'
                                        ><%= typeof(content) !== 'undefined' && content || '' %></textarea>
                                    </div>
                                    <div class='editor_buttons'>
                                        <input type="submit" class='btn btn-primary' data-loading-text="提交中"
                                        value="提交">
                                    </div>
                                </div>
                                <input type='hidden' name='_csrf' value='<%= csrf %>'>
                            </fieldset>
                        </form>
                    </div>
                    <% } %>
                </div>
                <div class="hidden-xs col-lg-3">
                    <%- partial('sidebar') %>
                </div>
            </div>
        </div>
    </div>
    <!-- markdown editor -->
    <%- Loader('/public/editor.min.js')
    .js('/public/lib/editor/editor.js')
    .js('/public/lib/webuploader/webuploader.withoutimage.js')
    .js('/public/lib/editor/ext.js')
    .done(assets, config.site_static_host, config.mini_assets)
    %>
    <%- Loader('/public/js/edit.min.js')
    .js('/public/lib/jquery.autocomplete.js')
    .js('/public/js/post.js')
    .done(assets, config.site_static_host, config.mini_assets)
    %>